<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Page</title>
    <link href="../styles/QuizStyles.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- imported components -->
    <script type="module" src="main.jsx"></script>
</head>
<body>
    <div class="card-container quiz">
        <div class="upper-portion">
            <div class="short-container score-counter">
                <p id="score">Score: 0</p> 
            </div>
            <div id="quit-button" class="quit-btn">
                Quit
            </div>
        </div>
        <div id='question' class="question-container">
            <p id="sentence"></p>
        </div>

        <!-- options container START -->
        <div id="options" class="options-container">
        </div>
        <!-- options container END -->

        <!-- bottom portion START -->
        <div class="bottom-portion">
            <button id="next-button" class="small-btn">
                Next
            </button>
        </div>
        <!-- bottom portion END -->
    </div>

    <script>
        $(document).ready(function() {
            let questions = [];
            let currentQuestionIndex = 0;
            let score = 0;

            // Fetch questions from the server
            $.getJSON('http://localhost:5137/questions')
                .done(function(data) {
                    questions = data;
                    loadQuestion();
                })
                .fail(function() {
                    console.error('Failed to fetch questions from the server.');
                });

            // Function to load the current question
            function loadQuestion() {
                if (currentQuestionIndex < questions.length) {
                    const question = questions[currentQuestionIndex];
                    $('#sentence').text(question.question);
                    $('#options').empty();
                    question.options.forEach((option, index) => {
                        const optionButton = $('<button>')
                            .addClass('options-default')
                            .text(`${String.fromCharCode(65 + index)}. ${option}`)
                            .click(() => checkAnswer(option));
                        $('#options').append(optionButton);
                    });
                } else {
                    console.log('No more questions.');
                    window.location.href = 'resultsPage.html';
                }
            }

            // Function to check the answer
            function checkAnswer(selectedOption) {
                const question = questions[currentQuestionIndex];
                if (selectedOption === question.answer) {
                    score++;
                    $('#score').text(`Score: ${score}`);
                }
                currentQuestionIndex++;
                loadQuestion();
            }

            // Handle next button click
            $('#next-button').click(function() {
                currentQuestionIndex++;
                loadQuestion();
            });
        });
    </script>
</body>
</html>